num_trials = 1000000

num_fit_samps = 100000
num_bid_pts = 500
num_mus = 500

kinds_params_list = [
  [[0.25942529155972954, -0.6387428796091523, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.29859047679958006, -0.6594919603654286, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.11881257006962632, -0.7197237746751309, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.2086474051371047, -0.6725107977101146, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.15051141665330103, -0.6600723428222443, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[-0.4340658433296816, -0.7089668449174702, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.47785756840290317, -0.7091063299832134, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[0.059395582822920116, -0.6670086804380768, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.032547165611482964, -0.6452733425650466, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.17338835519223664, -0.7502595142805709, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.4898139637572338, -0.6893596716217991, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.13727623727202543, -0.6189995055875174, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.08832124919246186, -0.5209981274665052, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.003905892774905907, -0.5867283737866168, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.5817062066181515, -0.5214070082457805, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.07876220444663387, -0.693042067438429, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.29777011877195786, -0.6082157671924446, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[-0.10161395603680565, -0.7417687721028211, 1.4230249470757705, 0.17888543819998318, 0.4444444444444445, 0.7], [0.2484203175316724, -0.5267028321314406, 1.4230249470757705, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.6263131722105711, -0.6455453796562842, 1.4230249470757705, 0.17888543819998318, 0.4444444444444445, 0.7], [0.11675225559932693, -0.551511653611542, 1.4230249470757705, 0.17888543819998318, 0.4444444444444445, 0.7], [0.44896628973507896, -0.5789744477647404, 1.4230249470757705, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[0.1920682956354181, -0.6045773115953161, 0.4743416490252569, 0.17888543819998318, 0.4444444444444445, 0.7], [0.17847360652928054, -0.5648247996573804, 0.4743416490252569, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.04014593918126533, -0.6497741815239955, 0.4743416490252569, 0.17888543819998318, 0.4444444444444445, 0.7], [0.19743823100883964, -0.5923472184563036, 0.4743416490252569, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.09713274490810436, -0.645934122539002, 0.4743416490252569, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[-0.1678615338246478, -0.4291686239500826, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.08234202537330215, -0.28458394189254865, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.1340883170040639, -0.3029584353796462, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.12658803321909978, -0.3821768746482733, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.115464745038725, -0.40162906667311404, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[0.1907120867531476, -0.9605056833279111, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.19270382198126124, -1.038513483028789, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.20659004126687572, -0.9780553562378347, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [0.031039333355694292, -0.9814109063301343, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7], [-0.24513501664740603, -0.9987397237820227, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.7]],
  [[-0.2103132930788641, -0.62, 0.9486832980505138, 0.0, 0.4444444444444445, 0.7], [-0.3497393108585757, -0.62, 0.9486832980505138, 0.0, 0.4444444444444445, 0.7], [0.09331712271178116, -0.62, 0.9486832980505138, 0.0, 0.4444444444444445, 0.7], [0.06346780562951364, -0.62, 0.9486832980505138, 0.0, 0.4444444444444445, 0.7], [0.2634119375333513, -0.62, 0.9486832980505138, 0.0, 0.4444444444444445, 0.7]],
  [[0.16447792739776315, -0.4540454283463117, 0.9486832980505138, 0.8944271909999159, 0.4444444444444445, 0.7], [-0.18977765605910174, -1.172256663684867, 0.9486832980505138, 0.8944271909999159, 0.4444444444444445, 0.7], [0.008696278289225964, -0.8777903440994406, 0.9486832980505138, 0.8944271909999159, 0.4444444444444445, 0.7], [-0.0622871387906222, -0.8678421066008206, 0.9486832980505138, 0.8944271909999159, 0.4444444444444445, 0.7], [0.17470899601166062, -0.28132747304098854, 0.9486832980505138, 0.8944271909999159, 0.4444444444444445, 0.7]],
  [[-0.023483143810079637, -0.6472595450515068, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, -0.5], [0.021905330435283185, -0.5226238354500591, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, -0.5], [0.2583983889695551, -0.603698038974968, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, -0.5], [-0.22388277290164127, -0.457802548966912, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, -0.5], [-0.17642258867979774, -0.6667150495675923, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, -0.5]],
  [[-0.02502832971732051, -0.6927015607097188, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.0], [0.35232768736194314, -0.5847413219838745, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.0], [-0.16150201704655373, -0.5480871559152469, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.0], [0.7249598739692841, -0.5917182181848393, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.0], [-0.17463178672595098, -0.6986217164882091, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 0.0]],
  [[-0.11943559600797009, -0.6537814881957681, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 1.0], [0.22699970056126925, -0.5557947884857695, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 1.0], [0.2802159904799968, -0.5407429493344492, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 1.0], [-0.05793114169191654, -0.636385399672224, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 1.0], [0.10002199621888927, -0.5917095080000275, 0.9486832980505138, 0.17888543819998318, 0.4444444444444445, 1.0]],
  [[0.061959064079227404, -0.5610915518314638, 0.7071067811865476, 0.11547005383792515, 0.5, 0.7], [-0.8114589377221817, -0.8687166753597503, 0.7071067811865476, 0.11547005383792515, 0.5, 0.7], [-0.06354933311120275, -0.44354170244937263, 0.7071067811865476, 0.11547005383792515, 0.5, 0.7], [0.853930899725944, -0.3635125138061042, 0.7071067811865476, 0.11547005383792515, 0.5, 0.7], [0.08784903605482201, -0.5506974294224124, 0.7071067811865476, 0.11547005383792515, 0.5, 0.7]],
  [[0.09267083224002307, -0.6801040289438437, 0.7071067811865476, 0.06030226891555273, 0.1, 0.7], [0.15482369640767457, -0.8288558856173673, 0.7071067811865476, 0.06030226891555273, 0.1, 0.7], [1.2848348782306749, -0.2233121944652519, 0.7071067811865476, 0.06030226891555273, 0.1, 0.7], [1.1017050337497445, -0.3924405840324776, 0.7071067811865476, 0.06030226891555273, 0.1, 0.7], [0.7159357909012437, -0.43464224013739355, 0.7071067811865476, 0.06030226891555273, 0.1, 0.7]],
  [[0.5560861141933993, -0.4540387785996004, 0.9486832980505138, 0.14142135623730953, 0.11111111111111112, 0.7], [-0.10420715495336291, -0.893377600103064, 0.9486832980505138, 0.14142135623730953, 0.11111111111111112, 0.7], [0.1860579161447541, -0.5349048803823488, 0.9486832980505138, 0.14142135623730953, 0.11111111111111112, 0.7], [-0.5213184572302857, -0.6759693281439013, 0.9486832980505138, 0.14142135623730953, 0.11111111111111112, 0.7], [0.053991656725974654, -0.6129463761722759, 0.9486832980505138, 0.14142135623730953, 0.11111111111111112, 0.7]],
  [[0.31891054217956233, -0.542138481813767, 0.9486832980505138, 0.18708286933869708, 0.7777777777777777, 0.7], [-0.3714568373691079, -0.7307565803378561, 0.9486832980505138, 0.18708286933869708, 0.7777777777777777, 0.7], [0.014137748957034015, -0.5843901426234357, 0.9486832980505138, 0.18708286933869708, 0.7777777777777777, 0.7], [0.31898645558537114, -0.5378675910980724, 0.9486832980505138, 0.18708286933869708, 0.7777777777777777, 0.7], [0.36496377767349064, -0.5648830530204568, 0.9486832980505138, 0.18708286933869708, 0.7777777777777777, 0.7]],
  ]

ns_params_list = [
   5,
   2,
   10,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
   5,
  ]

ns_list = [
   [1, 1, 1, 1, 1],
   [1, 1],
   [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
   [1, 1, 1, 1, 1],
  ]

import numpy as np
import matplotlib.pyplot as plt

results_list = [
  # simul_welfare, simul_revenue, descend_welfare, descend_revenue, opt_welfare, frac_inspect_simul, frac_simul_winners_inspect, frac_simul_winners_opt, never_inspect_welfare, never_inspect_revenue, random_welfare
  [2.857479387060741, 1.474949953616484, 2.9747837900376597, 2.3901355597323843, 2.9748816378378877, 0.19457720000000228, 0.3021805999999992, 0.30198480000000383, 0.5880519999999941, 0.8212349999999968, 2.7432593903122684, 1.5206976198712554, 1.2066000389776332],
  [0.8087928398672981, 0.21036665400007037, 0.8138206566223459, 0.4352515512669326, 0.8176321923384748, 0.10565000000000077, 0.5433145000000112, 0.514890499999993, 0.1918120000000054, 0.9309990000000183, 0.8067162873217901, 0.2132810190706256, 0.4939888322072414],
  [3.7520149607743685, 2.130212200240786, 3.9582044791821756, 3.649236217148012, 3.9582182590707116, 0.12494080000000364, 0.1752795999999927, 0.1752237000000092, 0.6489740000000255, 0.7834670000000011, 3.5380803480669716, 2.1616106284742767, 1.1306308788141157],
  [7.76596890582592, 2.486801287577647, 7.957286226168047, 5.418890338622814, 7.9576075961204, 0.39277880000000054, 0.41806920000001213, 0.41754339999998163, 0.8354290000000256, 0.8696479999999897, 6.7954404764375544, 2.8979076052874957, 2.4225834089428036],
  [1.1479496425744566, 0.8245209009256869, 1.1537740978245963, 1.1039687400241578, 1.1537779808467237, 0.005772800000000077, 0.20977520000000296, 0.20975359999999776, 0.02773099999999985, 0.9495409999999896, 1.147533620232054, 0.8245662268976863, 0.6778234264546876],
  [2.164022879436346, 1.0808407208197328, 2.2387566332194377, 1.8135426036368743, 2.2388913470624288, 0.10142019999999437, 0.25616760000000066, 0.25599320000000275, 0.3693570000000007, 0.8502059999999898, 2.1292956961155296, 1.1005451913234388, 0.8379991317716727],
  [3.0426225391596864, 1.602390759080335, 3.1710700730338535, 2.6212590709182977, 3.1710994248049693, 0.27730580000000044, 0.34418119999998736, 0.3440658000000049, 0.7138159999999656, 0.8231950000000072, 2.848442890894604, 1.6569888809371436, 1.337040983935572],
  [2.6025588858124107, 1.2860636492802273, 2.697393507798411, 2.2485100375466147, 2.69752620538842, 0.1809776000000018, 0.2893240000000001, 0.2890518000000014, 0.5719179999999882, 0.8389049999999992, 2.5029318949781074, 1.3337717420908866, 1.0248809115815651],
  [1.98098167929279, 1.1264450646872843, 2.0656479528963487, 1.7285437613007886, 2.0656730116311537, 0.1958019999999982, 0.30697699999999145, 0.30706959999999756, 0.4928040000000022, 0.8226029999999773, 1.9128689259035263, 1.129295846943272, 0.8577608829783187],
  [2.576409792036932, 1.2556744695259288, 2.6637522462092638, 2.1594357404235804, 2.6639942258419635, 0.18713199999999428, 0.28999779999998504, 0.28965059999997833, 0.5781070000000276, 0.845499000000008, 2.468601787682556, 1.3065612794012147, 0.9761225646560193],
  [3.6380283420344353, 1.6600899093308294, 3.7483305258461006, 2.835450212726446, 3.7492562031362517, 0.22588960000000574, 0.304047000000013, 0.3026289999999928, 0.6845950000000052, 0.8498219999999926, 3.4731851654222794, 1.7412304378342556, 1.3843176396573666],
  [2.70069673525545, 1.425631051224145, 2.8203559884870444, 2.2942779416062944, 2.82041317176203, 0.1610963999999992, 0.2909876000000011, 0.29088759999999064, 0.5205410000000026, 0.8151130000000028, 2.6187708192747214, 1.459464578673698, 1.1693809162340698],
  [2.5334862906358167, 1.1193303570746662, 2.560992936114555, 2.241281479705723, 2.5617827949402923, 0.11311639999999434, 0.22597459999999744, 0.22482579999999575, 0.5158069999999907, 0.9200199999999988, 2.5239006453755546, 1.1282969906909663, 0.9272908637839737],
  [4.510500811563862, 2.784215031463505, 4.67713180277073, 3.8985392916319066, 4.677415002106961, 0.3317713999999924, 0.3519810000000141, 0.35065519999999206, 0.8647740000000136, 0.8594890000000062, 4.099919519172093, 2.987824227911977, 2.1939878926605143],
  [2.51850063969411, 1.4058063688257303, 2.6711454611053504, 2.4711473534450077, 2.6711473431546957, 0.31438520000001646, 0.39172559999999595, 0.3915590000000076, 0.7657739999999874, 0.7863870000000215, 2.2527279486483955, 1.4503363823678364, 1.1837167617803384],
  [3.559257169763428, 1.5947889438985299, 3.6087897747011493, 2.9179034018117793, 3.608987974347089, 0.0656726000000015, 0.22886480000000228, 0.22873000000000027, 0.27703800000000034, 0.9093300000000188, 3.543866373465384, 1.6042195428154582, 1.2844055236604244],
  ]

max_std_error = 0.015675265143623253

std_errors = [
  [0.003289650284583168, 0.0009882860497915313, 0.0022557472336120037, 0.0014950106390634375, 0.002255750208834006, 0.0001705932658173335, 0.00013898138112518766, 0.00013884898216407507, 0.0004921860294066565, 0.00038315561014191723, 0.0016060293193988753, 0.000755387048073709, 0.000648588123530317],
  [0.0011866799350746093, 0.0002903380241849034, 0.0008644675790382164, 0.0003769475811517775, 0.0008606259737947054, 0.0002141917911081637, 0.00014064538339694302, 0.00014623626224297056, 0.0003937261887102594, 0.00025345596508846333, 0.0007284730875228752, 0.0002837541988542461, 0.0005102597980044284],
  [0.004077822001079609, 0.0012866979254801709, 0.0027209595724537496, 0.0023410377742245077, 0.002720960762915441, 9.834137565839716e-05, 9.100511032777352e-05, 9.097336552235178e-05, 0.0004772912896030853, 0.00041188181503633357, 0.0018820807575039267, 0.0008749345351524475, 0.0004496844982056289],
  [0.015675265143623253, 0.002973302441417351, 0.0123559061113134, 0.006057899388486121, 0.012355967701544918, 0.0002077657754231339, 0.0001885532804373871, 0.000188378089497544, 0.00037079310059185956, 0.00033669046534832276, 0.006246422545097382, 0.0020982944864898255, 0.0028174478034622],
  [0.00039669559186561676, 0.0002246829751278545, 0.0003734308524250466, 0.00034559874123225404, 0.0003734296823343644, 3.357790802947584e-05, 4.4038703481908124e-05, 4.398987635978485e-05, 0.00016420115286142179, 0.00021889024014774453, 0.0003592942442910449, 0.00022436170271382532, 0.00015504753534642833],
  [0.002645322068080966, 0.0007494258468076958, 0.0017684613403409317, 0.001275067808630919, 0.0017684487214093606, 0.000132862638406893, 0.00010381103740437127, 0.00010358364872571287, 0.00048263095578675633, 0.00035686956289361567, 0.0013656264204743645, 0.0006463091166691704, 0.000521171963719257],
  [0.003307253672248897, 0.0010657199160751438, 0.0023374128370457054, 0.001612595383476713, 0.002337416468057265, 0.0001943974564564353, 0.00016507976501645746, 0.0001650168249025326, 0.000451976683499181, 0.00038150378441129015, 0.001567650709258747, 0.0007539460843756454, 0.0006800196722474144],
  [0.0030436193216385223, 0.0008973872488768664, 0.0021570437583017543, 0.0016042910117881875, 0.0021570344477229307, 0.00016530388871292617, 0.00012885386927569993, 0.00012863744969624343, 0.0004948010166764478, 0.0003676187374421195, 0.0015231883488082225, 0.0007189715010406744, 0.0006134125646390055],
  [0.002199062692171313, 0.0006797732091835906, 0.0013272873513347186, 0.0009642220596227697, 0.001327282687681864, 0.00017628842240376515, 0.00014654822737714736, 0.00014657517607058517, 0.0004999484648766054, 0.00038200451609692027, 0.0010421094807089792, 0.0005036830298219361, 0.00046560415802988946],
  [0.0029758985838077793, 0.0008919523729717439, 0.00215919931498119, 0.0015502594413141656, 0.0021591787774287736, 0.00016981885470831784, 0.00012941952226991178, 0.0001291564423520047, 0.0004938618637337169, 0.00036142851524136, 0.0015012072773152867, 0.0007259895586109362, 0.0006250466067983422],
  [0.0042305518101827195, 0.0011599818409603322, 0.0031749765874048833, 0.001872537949003771, 0.0031751172267017623, 0.00016340280080927677, 0.0001381067734199884, 0.00013740854136518217, 0.0004646772018292937, 0.00035724598799804006, 0.002191505845133786, 0.0009188053733071966, 0.0008340918610538603],
  [0.003189130854922819, 0.0009237270692047699, 0.002080769355731918, 0.0014099531715233548, 0.00208078012064981, 0.00015994841509228962, 0.00013258444186583007, 0.00013251211916538415, 0.0004995781389305488, 0.00038820606375344717, 0.0015355014049411911, 0.0007210574504226954, 0.0006084981342949629],
  [0.002249788447065252, 0.0005700937498436428, 0.0016939266896938232, 0.0014627957433118405, 0.0016935883008140898, 0.00010304741952038659, 7.097383455982335e-05, 6.949679477619382e-05, 0.0004997503261643575, 0.0002712623696410344, 0.001463406988243704, 0.0005608359626354364, 0.00043219802747434546],
  [0.003911409934953809, 0.0013043801072979261, 0.0018437580036885183, 0.0012300984370361822, 0.0018438727428861084, 0.00010722923873715527, 0.00014901140172281343, 0.00014837625392384284, 0.00034196497754017077, 0.00034751658902385695, 0.0009180634333357106, 0.0006249951320650333, 0.0005906990221591822],
  [0.003523811396595948, 0.0008357969860314032, 0.001464393181128745, 0.0012920046086860575, 0.0014643930125559348, 0.00014759772290265125, 0.00019342112531047745, 0.0001933507354615093, 0.00042351429761975897, 0.00040985687039948095, 0.0007485819995254882, 0.0003914387466580882, 0.00044346861578625297],
  [0.0035655017259919614, 0.0011483589318868753, 0.003247156785217199, 0.0024829369354464705, 0.0032471076558851708, 0.00010958413031968544, 7.49759224174602e-05, 7.472477958343304e-05, 0.0004475356375129681, 0.0002871393974170631, 0.0028971316660819832, 0.001108426290025587, 0.0008849939915265265],
  ]



print("Welfare")
print("-------")
print("#   simul (std err)   descending (std err)   first-best (std err)   |   never-inspect (std err)   random (std err)")
for i,res in enumerate(results_list):
  print("%2d   %7.3f (%5.3f)   %7.3f (%5.3f)   %7.3f (%5.3f)   |   %7.3f (%5.3f)   %7.3f (%5.3f)"
        % (i+1, res[0], std_errors[i][0], res[2], std_errors[i][2], res[4], std_errors[i][4], res[10], std_errors[i][10], res[12], std_errors[i][12]))

print("")
print("Welfare as percent of first-best")
print("--------------------------------")
print("#   simul   descending   |   never-inspect   random")
for i,res in enumerate(results_list):
  opt = res[4]
  if opt == 0.0:
    print("-----------")
  else:
    print("%2d   %7.2f   %7.2f   |   %7.2f   %7.2f"
          % (i+1, 100*res[0]/opt, 100*res[2]/opt, 100*res[10]/opt, 100*res[12]/opt))

print("")
print("Revenue")
print("-------")
print("#   simul (std err)   descending (std err)   |   never-inspect (std err)")
for i,res in enumerate(results_list):
   print("%2d   %7.3f (%5.3f)   %7.3f (%5.3f)   |   %7.3f (%5.3f)"
         % (i+1, res[1], std_errors[i][1], res[3], std_errors[i][3], res[11], std_errors[i][11]))

print("")
print("Revenue as percent of descending")
print("--------------------------------")
print("#   simul   |   never-inspect")
for i,res in enumerate(results_list):
  desc = res[3]
  if desc == 0.0:
    print("---------")
  else:
    print("%2d   %7.3f   |   %7.3f"
          % (i+1, 100*res[1]/desc, 100*res[11]/desc))

print("")
print("Percent of bidders inspecting")
print("-----------------------------")
print("#   simul (std err)   descending (std err)   opt (std err)")
for i,res in enumerate(results_list):
  print("%2d   %5.2f (%5.2f)   %5.2f (%5.2f)   %5.2f (%5.2f)"
        % (i+1, 100*res[5], 100*std_errors[i][5], 100*res[6], 100*std_errors[i][6], 100*res[7], 100*std_errors[i][7]))

print("")
print("Simultaneous auction stats")
print("--------------------------")
print("percent of times winner inspected and")
print("percent of times winner had highest covered call")
print("#   winner_insp (std err)   winner_was_opt (std err)")
for i,res in enumerate(results_list):
  print("%2d   %7.2f (%5.2f)   %7.2f (%5.2f)"
        % (i+1, 100*res[8], 100*std_errors[i][8], 100*res[9], 100*std_errors[i][9]))

width = 0.27
inds = np.arange(len(results_list))
one_inds = np.arange(1, len(results_list)+1)

## welfare plot
ax = plt.figure()
simul = plt.bar(one_inds, [r[0] for r in results_list], width, yerr=[s[0] for s in std_errors], color='green')
descend = plt.bar(one_inds + width, [r[2] for r in results_list], width, yerr=[s[2] for s in std_errors], color='blue')
opt = plt.bar(one_inds + 2*width, [r[4] for r in results_list], width, yerr=[s[4] for s in std_errors], color='red')
plt.ylabel("welfare")
plt.xlabel("parameter set")
plt.legend([simul[0], descend[0], opt[0]], ["Simultaneous", "Descending", "Opt"])
plt.xticks(one_inds)
plt.title("Welfare")

## revenue plot
ax = plt.figure()
simul = plt.bar(one_inds, [r[1] for r in results_list], width, yerr=[s[1] for s in std_errors], color='green')
descend = plt.bar(one_inds + width, [r[3] for r in results_list], width, yerr=[s[3] for s in std_errors], color='blue')
plt.ylabel("revenue")
plt.xlabel("parameter set")
plt.legend([simul[0], descend[0]], ["Simultaneous", "Descending"])
plt.xticks(one_inds)
plt.title("Revenue")

plt.show()
